global allocs


probe process.function("_PyObject_Malloc").return {
    allocs[$return] = sprint_merged_stack()
}

probe process.function("_PyObject_Free").return {
    delete allocs[$p]
}

probe timer.s($1) {
    foreach (ptr in allocs) {
        println(allocs[ptr])
    }
    exit()
}
